package eubr.atmosphere.tma.planning
 
dialect "mvel"

import eubr.atmosphere.tma.planning.AdaptationManager
import eubr.atmosphere.tma.planning.Action
import eubr.atmosphere.tma.utils.Score


declare Score
      @role(event)
      //@expires(1s)
      //@timestamp (eventDestinationTimestamp)
 end


rule "Score validation number"
    when
        $number: Number ( )
    then
        System.out.println( "The current score is: " + $number.toString());
end

rule "Score validation"
    when
        $score: Score ( score > 0.4 )
    then
        Action action = new Action("[Score] High score: " + $score.toString(), 11);
        AdaptationManager.performAdaptation( action );
end

rule "Score validation average"
    when
	$my_avg : Number( avg : doubleValue > 0.35 ) from accumulate(
			Score( $score : score ) over window:length( 5 ),
			average ( $score ) )
    then
        Action action = new Action("Average-high " + $my_avg.toString(), 8);
        AdaptationManager.performAdaptation( action );
end
